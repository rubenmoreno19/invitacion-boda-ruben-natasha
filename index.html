<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rubén & Natasha — Invitación</title>

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">

  <meta name="description" content="Invitación de boda - Rubén & Natasha">

  <!-- ASSETS:
       Asegúrate de subir:
       /images/Boda1.jpg
       /images/Brujula.webp
       /images/Spain.png
       /images/Russia.png
       /images/ceremonia.jpg
       /images/coctel.jpg
       /images/baile.jpg
       /images/fin.jpg
       /audio/myonlyone.mp3
      PASOS:
      Sección1: Hasta la canción se queda como está
      Sección2: Calendario
      Sección3: Pasaporte
      Sección4: Boarding pass
      Sección5: Cronología
      Sección6: Scroll fotos
      Sección7: Dress code y números
      Sección8: Countdown y formulario
      Sección9: Mapa
  -->

  <style>
    :root{
      --accent: #b78a6b;
      --accent-dark: #8b5a3f;
      --bg: #faf4ec;
      --card:#fff;
      --text:#3b3029;
      --muted: rgba(0,0,0,0.55);
      --shadow: 0 10px 30px rgba(0,0,0,0.06);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: 'Montserrat', system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      justify-content:center;
      padding:18px;
    }

    .wrap{width:100%;max-width:760px}

    /* topbar (flags) */
    .topbar{display:flex;justify-content:center;gap:12px;margin-bottom:12px}
    .lang-btn{
      width:38px;height:38px;border-radius:50%;overflow:hidden;border:2px solid rgba(0,0,0,0.06);cursor:pointer;
      display:inline-flex;align-items:center;justify-content:center;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.06);
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .lang-btn img{width:100%;height:100%;object-fit:cover;display:block}
    .lang-btn:active{transform:scale(.98)}

    /* hero */
    .card-hero{background:var(--card);border-radius:16px;overflow:hidden;box-shadow: 0 18px 40px rgba(34,34,34,0.06);border:1px solid rgba(0,0,0,0.03);position:relative;}
    .hero-img{width:100%;height:280px;object-fit:cover;display:block;}
    .hero-overlay{padding:18px;display:flex;gap:12px;align-items:center;}
    .hero-title{font-family:'Playfair Display',serif;font-size:28px;color:var(--accent-dark);margin: 0;font-weight:bold;}
    .hero-sub{color:var(--muted);font-size:13px;margin-top:6px;font-weight:bold;}

    /* compass */
    .compass-row{display:flex;align-items:center;gap:12px}
    .compass{width:64px;height:64px;border-radius:50%;object-fit:cover;animation:spin 18s linear infinite;border:4px solid #fff;box-shadow:0 6px 20px rgba(0,0,0,0.07)}
    @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

    /* audio */
    .audio-wrap{padding:8px 18px 18px;margin-top: 0;}
    .audio-mus{font-family:'Playfair Display',serif;font-size:20px;color:var(--accent-dark);margin: 0;font-weight:bold;margin-bottom: 6px;text-align:center;width:100%;}
    audio{width:100%;border-radius:10px;outline:none}

    /* countdown */
    /*.countdown-wrap{padding:18px;background:linear-gradient(180deg,rgba(255,255,255,0.6),rgba(255,255,240,0.6));display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:wrap}*/
    /*.countdown-wrap{padding:18px;background:linear-gradient(180deg,rgba(255,255,255,0.6),rgba(255,255,240,0.6));display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch}*/
    .countdown-wrap{margin-top:6px;padding:18px;background:transparent;display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch;box-shadow:none;border:none}
    /*.cd-item{min-width:70px;padding:8px 12px;border-radius:12px;background:var(--card);box-shadow:0 8px 18px rgba(0,0,0,0.06);border:1px solid rgba(0,0,0,0.04);display:flex;flex-direction:column;align-items:center;gap:6px}*/
    .cd-item{background:#fff;min-width:60px;padding:8px 10px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.05);border:1px solid rgba(0,0,0,0.04)display:flex;flex-direction:column;align-items:center;gap:6px;flex-shrink:0}
    .cd-item .num{font-family:'Playfair Display',serif;font-size:28px;color:var(--accent-dark);letter-spacing:1px}
    .cd-item small{font-size:11px;color:rgba(0,0,0,0.6);text-transform:uppercase}

    /* actions */
    .actions{padding:16px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center;align-items:center}
    .btn{padding:10px 14px;border-radius:999px;border:1px solid rgba(0,0,0,0.06);background:var(--card);cursor:pointer;font-weight:600}
    .btn.primary{background:var(--accent);color:white;border-color:transparent;box-shadow:0 8px 18px rgba(183,155,107,0.14)}

    /* boarding pass */
    .section{padding:18px;margin-top:6px;}
    .card{background:var(--card);border-radius:12px;padding:12px}
    .ticket{background:linear-gradient(180deg,#fff,#fbf6f2);border-radius:12px;padding:14px;border:1px dashed rgba(0,0,0,0.06);box-shadow:var(--shadow)}
    .ticket h3{font-family:'Playfair Display',serif;margin:0;color:var(--accent-dark);font-size:18px}
    .meta{margin-top:10px;color:rgba(0,0,0,0.6);font-size:14px}
    .ticket hr{border:none;border-top:1px dashed rgba(0,0,0,0.06);margin:12px 0}

    /* TIMELINE: vertical line + dots, responsive-friendly */
    .timeline { position: relative; margin: 20px 0; padding-left: 56px; } /* room for line and time */
    .timeline::before { content: ""; position: absolute; left: 28px; top: 0; bottom: 0; width: 4px; background: var(--accent); border-radius:2px; }
    .timeline-item { position: relative; margin-bottom: 36px; display:flex; gap:16px; align-items:flex-start; opacity:0; transform:translateY(24px); transition: all .6s cubic-bezier(.2,.9,.2,1); }
    .timeline-item.visible{ opacity:1; transform:translateY(0); }
    /* dot */
    .timeline-item::before { content: ""; position:absolute; left:20px; top:8px; width:18px; height:18px; background:var(--card); border-radius:50%; box-shadow:0 0 0 4px var(--accent); border:2px solid white; }
    .timeline-item .time{ font-family:'Playfair Display',serif; font-size:16px; color:var(--accent-dark); min-width:70px; text-align:right; align-self:flex-start; padding-top:6px; }
    .timeline-item .content{ background:var(--card); border-radius:10px; padding:10px 14px; box-shadow:0 6px 16px rgba(0,0,0,0.05); flex:1; }
    .timeline-item img{ width:100%; border-radius:8px; margin-bottom:8px; object-fit:cover; max-height:140px; }
    .timeline-item h4{ margin:4px 0; font-size:16px; color:var(--accent-dark); }
    .timeline-item p{ margin:0; color:var(--muted); font-size:13px; }

    /* MOBILE FIXES for timeline */
    @media (max-width: 600px) {
      .timeline { padding-left: 48px; }
      .timeline::before { left: 24px; width: 3px; }
      .timeline-item {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 36px;
        position: relative;
      }
      .timeline-item::before { left: 16px; top: 50%; transform: translateY(-50%); }
      .timeline-item .time {
        min-width: 56px;
        font-size: 14px;
        text-align: right;
        margin-right: 6px;
        padding-top: 0;
        align-self: center;
      }
      .timeline-item .content { padding:12px; }
    }

    @media(min-width:900px){
      .hero-img{height:380px}
      .hero-title{font-size:30px}
      .cd-item .num{font-size:36px}
    }

     /* MOBILE FIXES for Countdown */
    @media (max-width: 420px) {
      .cd-item .num {
        font-size: 22px;
      }
      .cd-item {
        min-width: 55px;
        padding: 6px 8px;
      }
    }
    
    /* ====== CALENDAR STYLES (aplican en todo tamaño) ====== */
    .calendar-section {
      margin-top:6px;
      text-align: center;
      background-color: #fdfaf6;
      padding: 1.5rem 1rem;
      /*padding: 2.25rem 1rem;*/
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      margin: 1rem auto;
      /*margin: 2.5rem auto;*/
      max-width: 520px;
      font-family: 'Playfair Display', serif; /* match design */
    }

    .calendar-section h2 {
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--accent-dark);
      margin: 0 0 6px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .calendar-section h3 {
      font-size: 1.05rem;
      font-weight: 500;
      color: var(--accent);
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .calendar {
      display: inline-block;
      background-color: #f5eee6;
      padding: 1rem;
      border-radius: 20px;
      border: 1px solid #e2d3c2;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
    }

    .calendar-header {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.5rem;
      font-weight: 600;
      color: var(--accent-dark);
      font-size: 0.95rem;
      margin-bottom: 10px;
      font-family: 'Montserrat', sans-serif;
      letter-spacing: 1px;
    }

    .calendar-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.35rem;
      font-size: 1rem;
      color: #6b4b2e;
      width: 100%;
    }

    .calendar-days .day {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 36px;
      min-height: 36px;
      border-radius: 50%;
      background-color: transparent;
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      color: var(--accent-dark);
      position: relative;
      z-index: 1;
    }

    .calendar-days .empty {
      visibility: hidden;
    }

    /* special day: heart behind number */
    .calendar-days .special-day {
      font-weight: 700;
      color: var(--accent-dark);
      z-index: 2;
    }

    .calendar-days .special-day::before {
      content: "♡"; /* outline heart */
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%);
      font-size: 5rem;
      opacity: 0.95;
      z-index: 1;
      pointer-events: none;
    }

    /* when screen is small, make grid smaller and heart scale down */
    @media (max-width: 480px) {
      .calendar-section { padding: 1rem 0.4rem; margin: 0.1rem auto; }
      /*.calendar-section { padding: 1.5rem 0.6rem; margin: 1.6rem auto; }*/
      .calendar { padding: 0.5rem; }
      .calendar-header { font-size: 0.78rem; }
      .calendar-days .day { min-width: 34px; min-height: 34px; font-size: 1.1rem; }
      .calendar-days .special-day::before { font-size: 2.2rem; -webkit-text-stroke:2.2px #d4a373; text-stroke:2px #d4a373; transform: translate(-50%,-40%);}
    }
    /* ====== END CALENDAR STYLES ====== */

  </style>
</head>
<body>
  <div class="wrap">

    <!-- INICIO PÁGINA-->
    <!-- BANDERAS OK -->
      <div class="topbar" aria-hidden="false" 
         style="display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:16px;">
      
      <h3 style="font-family:'Playfair Display',serif;
                 color:var(--accent-dark);
                 font-size:18px;
                 margin:0;">Selecciona el idioma / Выберите язык</h3>
      <div style="display:flex;justify-content:center;gap:12px;margin-top:6px;">
        <div class="lang-btn" id="btn-es" title="Español" onclick="setLang('es')">
          <img src="Spain.png" alt="ES">
        </div>
        <div class="lang-btn" id="btn-ru" title="Русский" onclick="setLang('ru')">
          <img src="Russia.png" alt="RU">
        </div>
      </div>
    </div>
   
    <!-- INICIO PRIMERA SECCIÓN -->
    
    <!-- HERO (PHOTO & TEXT) OK-->
    <div class="card-hero">
      <img class="hero-img" src="images/Boda1.jpg" alt="Rubén & Natasha">
      <div class="hero-overlay">
        <div style="display:flex;flex-direction:column;align-items:flex-start">
          <div class="hero-title" data-i18n="names">Rubén & Natasha</div>
          <div class="hero-sub" data-i18n="subtitle">Este día del año va a ser muy especial para nosotros. Queremos estar rodeados de las personas más cercanas. Os invitamos a este día tan importante en nuestra vida: NUESTRA BODA!</div>
        </div>
        <div class="compass-row">
          <img class="compass" src="Brujula.webp" alt="Brújula">
        </div>
      </div>

      <!-- AUDIO -->
      <div class="audio-wrap">
        <div style="display:flex;flex-direction:column;align-items:flex-start">
          <div class="audio-mus" data-i18n="music">Escucha nuestra canción</div>
          <audio controls preload="none">
            <source src="myonlyone.mp3" type="audio/mpeg">
            Tu navegador no soporta audio.
          </audio>
        </div>
      </div>
     </div> <!-- Cierre PRIMERA SECCIÓN -->

    <!-- NUEVA SECCIÓN: Countdown + Actions -->
    <section class="section">
      <div class="calendar-section">
      <!-- COUNTDOWN -->
      <div class="countdown-wrap" aria-live="polite">
        <div class="cd-item"><div class="num" id="cd-days">00</div><small data-i18n="days">Días</small></div>
        <div class="cd-item"><div class="num" id="cd-hours">00</div><small data-i18n="hours">Horas</small></div>
        <div class="cd-item"><div class="num" id="cd-minutes">00</div><small data-i18n="minutes">Minutos</small></div>
        <div class="cd-item"><div class="num" id="cd-seconds">00</div><small data-i18n="seconds">Segundos</small></div>
      </div>

      <!-- ACTIONS -->
      <div class="actions">
        <a class="btn primary" href="https://forms.gle/Y3iuPmjdmrtKARxb8" target="_blank" rel="noopener" data-i18n="rsvp">Confirmar asistencia</a>
        <button class="btn" onclick="openGoogleCalendar()" data-i18n="add_gcal">Google Calendar</button>
        <button class="btn" onclick="downloadICS()" data-i18n="add_ical">Añadir a Outlook/iOS</button>
      </div>
      </div>
    </section>
    <!-- FIN SECCIÓN: Countdown + Actions -->

    <!-- ================= CALENDAR SECTION (dynamic) ================= -->
    <section id="calendario" class="calendar-section" aria-label="Calendario">
      <h2 data-i18n="calendar_title">El Gran Día</h2>
      <h3 id="calendar-month" data-i18n="calendar_month">Julio 2026</h3>

      <div class="calendar" role="application" aria-labelledby="calendar-month">
        <div class="calendar-header" aria-hidden="true">
          <span>LUN</span><span>MAR</span><span>MIE</span><span>JUE</span><span>VIE</span><span>SAB</span><span>DOM</span>
        </div>
        <div class="calendar-days" id="calendar-days">
          <!-- JS will render days here -->
        </div>
      </div>
    </section>
    <!-- ================ END CALENDAR ================= -->

    <!-- BOARDING PASS -->
    <section class="section">
      <div class="card">
        <div class="ticket" id="details-ticket">
          <div style="display:flex; flex-direction:column; align-items:center; text-align:center;">
            <h3 data-i18n="bp_title">BOARDING PASS</h3>
            <div class="meta" data-i18n="bp_flight">RN • 22/07/2026</div>
          </div>

          <hr style="border:none;border-top:1px dashed rgba(0,0,0,0.06);margin:12px 0"/>

          <div class="row" style="display:flex; flex-direction:column; gap:8px;">
            <div>
              <strong data-i18n="place_label">Ubicación</strong>
              <div class="meta" data-i18n="place_value">San Petersburgo (Rusia)</div>
            </div>
            <div>
              <strong data-i18n="date_label">Fecha y hora</strong>
              <div class="meta" data-i18n="date_value">22/07/2026 — 16:00</div>
            </div>
          </div>

          <div style="height:8px"></div>

          <div class="row" style="display:flex; flex-direction:column; gap:8px;">
            <div>
              <strong data-i18n="bp_destination_label">Destino</strong>
              <div class="meta" data-i18n="bp_destination_value">Royal Beach, San Petersburgo (Rusia)</div>
            </div>
            <div>
              <strong data-i18n="note_label">Nota</strong>
              <div class="meta" data-i18n="note">Por favor confirma asistencia antes del 01/02/2026.</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- TIMELINE -->
    <section class="section">
      <div class="ticket">
        <h3 style="text-align:center;font-family:'Playfair Display',serif;color:var(--accent-dark);margin-bottom:24px;" data-i18n="timeline_title">Cronograma del Día</h3>

        <div class="timeline">
          <div class="timeline-item">
            <div class="time">16:00</div>
            <div class="content">
              <img src="images/ceremonia.jpg" alt="Ceremonia">
              <h4 data-i18n="t1_title">Ceremonia</h4>
              <p data-i18n="t1_text">El momento más especial — ¡decimos sí quiero!</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="time">17:30</div>
            <div class="content">
              <img src="images/coctel.jpg" alt="Cóctel">
              <h4 data-i18n="t2_title">Cóctel</h4>
              <p data-i18n="t2_text">Brindis junto al mar con aperitivos y música suave.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="time">19:00</div>
            <div class="content">
              <img src="images/baile.jpg" alt="Baile">
              <h4 data-i18n="t3_title">Baile</h4>
              <p data-i18n="t3_text">¡A disfrutar la pista con nuestros mejores pasos!</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="time">23:00</div>
            <div class="content">
              <img src="images/fin.jpg" alt="Fin de la fiesta">
              <h4 data-i18n="t4_title">Fin de la fiesta</h4>
              <p data-i18n="t4_text">Despedida con fuegos artificiales y dulces recuerdos.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- INFO EXTRA -->
    <section class="section">
      <div class="ticket">
        <h3 data-i18n="more_title">Información importante</h3>
        <p class="meta" data-i18n="more_text">Aquí puedes añadir instrucciones sobre transporte, alojamiento o dress code.</p>
      </div>
    </section>

  </div>

  <script>
    /* ===========================
       TRANSLATIONS ES / RU
       =========================== */
    const TEXTS = {
      es: {
        names: 'Rubén & Natasha',
        subtitle: 'Este día del año va a ser muy especial para nosotros. Queremos estar rodeados de las personas más cercanas. Os invitamos a este día tan importante en nuestra vida: NUESTRA BODA!',
        music: 'Escucha nuestra canción',
        days: 'Días', hours: 'Horas', minutes: 'Minutos', seconds: 'Segundos',
        rsvp: 'Confirmar asistencia', add_gcal: 'Google Calendar', add_ical: 'Añadir a Outlook/iOS',
        bp_title: 'BOARDING PASS', bp_flight: 'RN • 22/07/2026',
        place_label: 'Ubicación', place_value: 'San Petersburgo (Rusia)',
        date_label: 'Fecha y hora', date_value: '22/07/2026 — 16:00',
        bp_destination_label: 'Destino', bp_destination_value: 'Royal Beach, San Petersburgo (Rusia)',
        note_label: 'Nota', note: 'Por favor confirma asistencia antes del 01/02/2026.',
        timeline_title: 'Cronograma del Día',
        t1_title: 'Ceremonia', t1_text: 'El momento más especial — ¡decimos sí quiero!',
        t2_title: 'Cóctel', t2_text: 'Brindis junto al mar con aperitivos y música suave.',
        t3_title: 'Baile', t3_text: '¡A disfrutar la pista con nuestros mejores pasos!',
        t4_title: 'Fin de la fiesta', t4_text: 'Despedida con fuegos artificiales y dulces recuerdos.',
        more_title: 'Información importante', more_text: 'Aquí puedes añadir instrucciones sobre transporte, alojamiento o dress code.',
        calendar_title: 'El Gran Día', calendar_month: 'Julio 2026'
      },
      ru: {
        names: 'Рубен & Наташа',
        subtitle: 'Один день в этом году будет для нас особенным и мы хотим провести его в кругу близких и друзей! С большим удовольствием приглашаем Вас на замечательный праздник- НАШУ СВАДЬБУ!',
        music: 'Послушайте нашу песню',
        days: 'Дней', hours: 'Часов', minutes: 'Минут', seconds: 'Секунд',
        rsvp: 'Подтвердить участие', add_gcal: 'Google Календарь', add_ical: 'Добавить в Outlook/iOS',
        bp_title: 'ПОСАДОЧНЫЙ ТАЛОН', bp_flight: 'RN • 22/07/2026',
        place_label: 'Место', place_value: 'Санкт-Петербург (Россия)',
        date_label: 'Дата и время', date_value: '22/07/2026 — 16:00',
        bp_destination_label: 'Пункт назначения', bp_destination_value: 'Royal Beach, Санкт-Петербург (Россия)',
        note_label: 'Примечание', note: 'Пожалуйста подтвердите участие до 01/02/2026.',
        timeline_title: 'Расписание дня',
        t1_title: 'Церемония', t1_text: 'Самый особенный момент — мы говорим «да»!',
        t2_title: 'Коктейль', t2_text: 'Тосты у моря с закусками и мягкой музыкой.',
        t3_title: 'Танцы', t3_text: 'Наслаждаемся танцевальной площадкой и нашими лучшими па!',
        t4_title: 'Завершение праздника', t4_text: 'Прощание с фейерверками и сладкими воспоминаниями.',
        more_title: 'Важная информация', more_text: 'Здесь можно добавить инструкции по транспорту, проживанию или дресс-коду.',
        calendar_title: 'Большой день', calendar_month: 'Июль 2026'
      }
    };

    /* Apply translations + highlight */
    let currentLang = (navigator.language && navigator.language.startsWith('ru')) ? 'ru' : 'es';

    function applyLang(lang){
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key = el.getAttribute('data-i18n');
        if(TEXTS[lang] && TEXTS[lang][key]) el.textContent = TEXTS[lang][key];
      });
      // calendar headings
      if(TEXTS[lang] && TEXTS[lang].calendar_title) document.querySelector('[data-i18n="calendar_title"]')?.setAttribute('data-i18n', 'calendar_title');
      if(TEXTS[lang] && TEXTS[lang].calendar_month) document.getElementById('calendar-month').textContent = TEXTS[lang].calendar_month;
    }

    function highlightLangButton(){
      const esBtn = document.getElementById('btn-es');
      const ruBtn = document.getElementById('btn-ru');
      if(!esBtn || !ruBtn) return;
      if(currentLang === 'es'){
        esBtn.style.boxShadow = '0 10px 26px rgba(139,94,80,0.18)';
        esBtn.style.transform = 'scale(1.04)';
        ruBtn.style.boxShadow = '0 6px 18px rgba(0,0,0,0.06)';
        ruBtn.style.transform = 'scale(1)';
      } else {
        ruBtn.style.boxShadow = '0 10px 26px rgba(139,94,80,0.18)';
        ruBtn.style.transform = 'scale(1.04)';
        esBtn.style.boxShadow = '0 6px 18px rgba(0,0,0,0.06)';
        esBtn.style.transform = 'scale(1)';
      }
    }

    function setLang(lang){
      currentLang = lang;
      applyLang(lang);
      highlightLangButton();
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      applyLang(currentLang);
      highlightLangButton();
    });

    /* ===========================
       COUNTDOWN
       =========================== */
    const weddingDate = new Date("2026-07-22T16:00:00+03:00").getTime();
    function updateCountdown(){
      const now = Date.now();
      const dist = weddingDate - now;
      if(dist < 0){
        document.getElementById('cd-days').textContent='00';
        document.getElementById('cd-hours').textContent='00';
        document.getElementById('cd-minutes').textContent='00';
        document.getElementById('cd-seconds').textContent='00';
        return;
      }
      document.getElementById('cd-days').textContent = String(Math.floor(dist/(1000*60*60*24))).padStart(2,'0');
      document.getElementById('cd-hours').textContent = String(Math.floor((dist%(1000*60*60*24))/(1000*60*60))).padStart(2,'0');
      document.getElementById('cd-minutes').textContent = String(Math.floor((dist%(1000*60*60))/(1000*60))).padStart(2,'0');
      document.getElementById('cd-seconds').textContent = String(Math.floor((dist%(1000*60))/1000)).padStart(2,'0');
    }
    updateCountdown();
    setInterval(updateCountdown,1000);

    /* ===========================
       Calendar renderer (Mon-first)
       =========================== */
    function renderCalendar(year, month, highlightDay){
      // month: 1-12
      const container = document.getElementById('calendar-days');
      container.innerHTML = '';
      const first = new Date(year, month-1, 1);
      // JS getDay(): 0=Sun ... 6=Sat. We want Mon-first (0=Mon)
      const firstWeekday = (first.getDay() + 6) % 7; // 0..6 where 0 = Monday
      // number of days in month:
      const daysInMonth = new Date(year, month, 0).getDate();

      // add empty slots for days before the 1st
      for(let i=0;i<firstWeekday;i++){
        const span = document.createElement('div');
        span.className = 'empty';
        container.appendChild(span);
      }

      // add days
      for(let d=1; d<=daysInMonth; d++){
        const span = document.createElement('div');
        span.className = 'day';
        span.textContent = d;
        if(d === highlightDay){
          span.classList.add('special-day');
          span.setAttribute('aria-label', `Día destacado ${d}`);
        }
        container.appendChild(span);
      }

      // fill remaining cells to complete last week (optional)
      const totalCells = container.children.length;
      const remainder = totalCells % 7;
      if(remainder !== 0){
        const toAdd = 7 - remainder;
        for(let i=0;i<toAdd;i++){
          const span = document.createElement('div');
          span.className = 'empty';
          container.appendChild(span);
        }
      }

      // set month label (if translations exist)
      const monthLabel = `${['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'][month-1]} ${year}`;
      if(TEXTS[currentLang] && TEXTS[currentLang].calendar_month){
        document.getElementById('calendar-month').textContent = TEXTS[currentLang].calendar_month;
      } else {
        document.getElementById('calendar-month').textContent = monthLabel;
      }
    }

    // render July 2026 with 22 highlighted
    renderCalendar(2026, 7, 22);

    /* ===========================
       Calendar helpers (Google + ICS)
       =========================== */
    function pad(n){return String(n).padStart(2,'0');}
    function toUTCStringForGoogle(d){
      const yyyy = d.getUTCFullYear();
      const mm = pad(d.getUTCMonth()+1);
      const dd = pad(d.getUTCDate());
      const hh = pad(d.getUTCHours());
      const min = pad(d.getUTCMinutes());
      const ss = pad(d.getUTCSeconds());
      return `${yyyy}${mm}${dd}T${hh}${min}${ss}Z`;
    }

    const event = {
      title: "Boda — Rubén & Natasha",
      description: "¡Ven a celebrar con nosotros! Por favor confirma asistencia.",
      location: "Royal Beach, San Petersburgo",
      start: new Date(2026,6,22,16,0,0),
      end: new Date(2026,6,22,23,0,0)
    };

    function openGoogleCalendar(){
      const s = toUTCStringForGoogle(event.start);
      const e = toUTCStringForGoogle(event.end);
      const url = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(event.title)}&dates=${s}/${e}&details=${encodeURIComponent(event.description)}&location=${encodeURIComponent(event.location)}`;
      window.open(url,'_blank');
    }

    function downloadICS(){
      function toICSDate(d){
        return `${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}00`;
      }
      const icsLines = [
        'BEGIN:VCALENDAR',
        'VERSION:2.0',
        'PRODID:-//Rubén&Natasha//Boda//ES',
        'CALSCALE:GREGORIAN',
        'BEGIN:VEVENT',
        `UID:${Date.now()}@boda`,
        `DTSTAMP:${toICSDate(new Date())}`,
        `DTSTART:${toICSDate(event.start)}`,
        `DTEND:${toICSDate(event.end)}`,
        `SUMMARY:${event.title}`,
        `DESCRIPTION:${event.description}`,
        `LOCATION:${event.location}`,
        'END:VEVENT',
        'END:VCALENDAR'
      ].join('\r\n');
      const blob = new Blob([icsLines],{type:'text/calendar'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'boda-ruben-natasha.ics'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }

    /* ===========================
       TIMELINE APPEAR ON SCROLL
       =========================== */
    const timelineObserver = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting) entry.target.classList.add('visible');
      });
    },{threshold:0.18});

    document.addEventListener('DOMContentLoaded', ()=>{
      document.querySelectorAll('.timeline-item').forEach(item=>timelineObserver.observe(item));

      // keyboard accessibility for flags
      document.querySelectorAll('.lang-btn').forEach(btn=>{
        btn.setAttribute('tabindex','0');
        btn.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter' || e.key === ' ') btn.click();
        });
      });
    });

    /* End script */
  </script>
</body>
</html>
